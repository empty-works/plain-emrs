-- MySQL Script generated by MySQL Workbench
-- Sa 05 Jun 2021 03:43:58
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema plain_emrs
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `plain_emrs` ;

-- -----------------------------------------------------
-- Schema plain_emrs
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `plain_emrs` ;
USE `plain_emrs` ;

-- -----------------------------------------------------
-- Table `plain_emrs`.`user`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `plain_emrs`.`user` ;

CREATE TABLE IF NOT EXISTS `plain_emrs`.`user` (
  `user_id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `username` VARCHAR(100) NULL,
  `password` CHAR(68) NULL,
  `last_signed_on` DATETIME NULL,
  `email_address` VARCHAR(254) NULL,
  `account_created_on` VARCHAR(45) NULL,
  `enabled` TINYINT(1) NULL,
  `person_id` INT NULL,
  PRIMARY KEY (`user_id`),
  UNIQUE INDEX `user_id_UNIQUE` (`user_id` ASC) VISIBLE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_unicode_520_ci;


-- -----------------------------------------------------
-- Table `plain_emrs`.`patient`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `plain_emrs`.`patient` ;

CREATE TABLE IF NOT EXISTS `plain_emrs`.`patient` (
  `patient_id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `given_name` VARCHAR(50) NULL,
  `middle_name` VARCHAR(50) NULL,
  `last_name` VARCHAR(50) NULL,
  `street_address` VARCHAR(100) NULL,
  `city` VARCHAR(45) NULL,
  `state` VARCHAR(50) NULL,
  `country` VARCHAR(55) NULL,
  `phone_number` VARCHAR(15) NULL,
  `insurance` VARCHAR(100) NULL,
  `department` VARCHAR(45) NULL,
  `room` VARCHAR(10) NULL,
  `date_of_birth` DATE NULL,
  PRIMARY KEY (`patient_id`),
  UNIQUE INDEX `patient_id_UNIQUE` (`patient_id` ASC) VISIBLE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_unicode_520_ci;


-- -----------------------------------------------------
-- Table `plain_emrs`.`medical_record`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `plain_emrs`.`medical_record` ;

CREATE TABLE IF NOT EXISTS `plain_emrs`.`medical_record` (
  `record_id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `patient_id` INT UNSIGNED NOT NULL,
  `latest_diagnosis_date` DATETIME NULL,
  `latest_diagnosis` BLOB NULL,
  `latest_appointment_date` DATETIME NULL,
  `latest_appointment_doctor_first_name` VARCHAR(50) NULL,
  `latest_appointment_doctor_last_name` VARCHAR(50) NULL,
  `latest_appointment_department` VARCHAR(50) NULL,
  `condition` VARCHAR(40) NULL,
  `last_visit_date` DATETIME NULL,
  `last_date_vitals_taken` VARCHAR(45) NULL,
  `current_height` INT NULL,
  `current_weight` INT NULL,
  `current_bmi` INT NULL,
  `last_recorded_temperature` FLOAT NULL,
  `current_pulse` INT NULL,
  `current_respiratory_rate` INT NULL,
  `current_bp_systolic` INT NULL,
  `current_bp_diastolic` INT NULL,
  `current_arterial_blood_oxygen_saturation` INT NULL,
  PRIMARY KEY (`record_id`, `patient_id`),
  UNIQUE INDEX `record_id_UNIQUE` (`record_id` ASC) VISIBLE,
  INDEX `fk_medical_record_patient1_idx` (`patient_id` ASC) VISIBLE,
  CONSTRAINT `fk_medical_record_patient1`
    FOREIGN KEY (`patient_id`)
    REFERENCES `plain_emrs`.`patient` (`patient_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_unicode_520_ci;


-- -----------------------------------------------------
-- Table `plain_emrs`.`diagnosis`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `plain_emrs`.`diagnosis` ;

CREATE TABLE IF NOT EXISTS `plain_emrs`.`diagnosis` (
  `record_id` INT NOT NULL,
  `date` DATETIME NULL,
  `diagnosis` BLOB NULL,
  PRIMARY KEY (`record_id`),
  CONSTRAINT `fk_diagnosis_medical_record1`
    FOREIGN KEY (`record_id`)
    REFERENCES `plain_emrs`.`medical_record` (`record_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `plain_emrs`.`appointment`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `plain_emrs`.`appointment` ;

CREATE TABLE IF NOT EXISTS `plain_emrs`.`appointment` (
  `record_id` INT NOT NULL,
  `date` DATETIME NULL,
  `doctor_first_name` VARCHAR(50) NULL,
  `doctor_last_name` VARCHAR(50) NULL,
  `department` VARCHAR(50) NULL,
  PRIMARY KEY (`record_id`),
  CONSTRAINT `fk_appointment_medical_record1`
    FOREIGN KEY (`record_id`)
    REFERENCES `plain_emrs`.`medical_record` (`record_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `plain_emrs`.`medication`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `plain_emrs`.`medication` ;

CREATE TABLE IF NOT EXISTS `plain_emrs`.`medication` (
  `record_id` INT NOT NULL,
  `medication` VARCHAR(150) NULL,
  `is_current` TINYINT NULL,
  PRIMARY KEY (`record_id`),
  CONSTRAINT `fk_medication_medical_record1`
    FOREIGN KEY (`record_id`)
    REFERENCES `plain_emrs`.`medical_record` (`record_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `plain_emrs`.`allergy`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `plain_emrs`.`allergy` ;

CREATE TABLE IF NOT EXISTS `plain_emrs`.`allergy` (
  `record_id` INT NOT NULL,
  `allergy` VARCHAR(75) NULL,
  PRIMARY KEY (`record_id`),
  CONSTRAINT `fk_allergy_medical_record1`
    FOREIGN KEY (`record_id`)
    REFERENCES `plain_emrs`.`medical_record` (`record_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `plain_emrs`.`visit`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `plain_emrs`.`visit` ;

CREATE TABLE IF NOT EXISTS `plain_emrs`.`visit` (
  `record_id` INT NOT NULL,
  `visit_date` DATETIME NULL,
  PRIMARY KEY (`record_id`),
  CONSTRAINT `fk_visit_medical_record1`
    FOREIGN KEY (`record_id`)
    REFERENCES `plain_emrs`.`medical_record` (`record_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `plain_emrs`.`vitals`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `plain_emrs`.`vitals` ;

CREATE TABLE IF NOT EXISTS `plain_emrs`.`vitals` (
  `record_id` INT NOT NULL,
  `date_taken` DATETIME NULL,
  `height` INT NULL,
  `weight` INT NULL,
  `calculated_bmi` INT NULL,
  `temperature` FLOAT NULL,
  `pulse` INT NULL,
  `respiratory_rate` INT NULL,
  `blood_pressure_systolic` INT NULL,
  `blood_pressure_diastolic` INT NULL,
  `arterial_blood_oxygen_saturation` INT NULL,
  PRIMARY KEY (`record_id`),
  CONSTRAINT `fk_vitals_medical_record1`
    FOREIGN KEY (`record_id`)
    REFERENCES `plain_emrs`.`medical_record` (`record_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `plain_emrs`.`access_log`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `plain_emrs`.`access_log` ;

CREATE TABLE IF NOT EXISTS `plain_emrs`.`access_log` (
  `user_id` INT NOT NULL,
  `username` VARCHAR(50) NULL,
  `date_time_of_visit` DATETIME NULL,
  PRIMARY KEY (`user_id`),
  CONSTRAINT `fk_access_log_user_account1`
    FOREIGN KEY (`user_id`)
    REFERENCES `plain_emrs`.`user` (`user_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `plain_emrs`.`family_relation`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `plain_emrs`.`family_relation` ;

CREATE TABLE IF NOT EXISTS `plain_emrs`.`family_relation` (
  `record_id` INT NOT NULL,
  `related_patient_id` INT NULL,
  `relation` VARCHAR(25) NULL,
  PRIMARY KEY (`record_id`),
  CONSTRAINT `fk_family_relations_medical_record1`
    FOREIGN KEY (`record_id`)
    REFERENCES `plain_emrs`.`medical_record` (`record_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `plain_emrs`.`role`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `plain_emrs`.`role` ;

CREATE TABLE IF NOT EXISTS `plain_emrs`.`role` (
  `role_id` VARCHAR(25) NOT NULL,
  `role_name` VARCHAR(45) NULL,
  PRIMARY KEY (`role_id`),
  UNIQUE INDEX `role_id_UNIQUE` (`role_id` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `plain_emrs`.`user_role`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `plain_emrs`.`user_role` ;

CREATE TABLE IF NOT EXISTS `plain_emrs`.`user_role` (
  `user_id` INT NOT NULL,
  `role_id` INT NOT NULL,
  PRIMARY KEY (`user_id`, `role_id`),
  INDEX `fk_users_roles_roles1_idx` (`role_id` ASC) VISIBLE,
  CONSTRAINT `fk_users_roles_users1`
    FOREIGN KEY (`user_id`)
    REFERENCES `plain_emrs`.`user` (`user_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_users_roles_roles1`
    FOREIGN KEY (`role_id`)
    REFERENCES `plain_emrs`.`role` (`role_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `plain_emrs`.`emergency_contact`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `plain_emrs`.`emergency_contact` ;

CREATE TABLE IF NOT EXISTS `plain_emrs`.`emergency_contact` (
  `emergency_contact_id` VARCHAR(45) NOT NULL,
  `given_name` VARCHAR(50) NULL,
  `middle_name` VARCHAR(50) NULL,
  `last_name` VARCHAR(50) NULL,
  `phone_number` VARCHAR(15) NULL,
  `email_address` VARCHAR(254) NULL,
  PRIMARY KEY (`emergency_contact_id`),
  UNIQUE INDEX `emergency_contact_id_UNIQUE` (`emergency_contact_id` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `plain_emrs`.`patient_emergency_contact`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `plain_emrs`.`patient_emergency_contact` ;

CREATE TABLE IF NOT EXISTS `plain_emrs`.`patient_emergency_contact` (
  `patient_id` INT NOT NULL,
  `emergency_contact_id` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`patient_id`, `emergency_contact_id`),
  INDEX `fk_table1_emergency_contact1_idx` (`emergency_contact_id` ASC) VISIBLE,
  CONSTRAINT `fk_table1_patient1`
    FOREIGN KEY (`patient_id`)
    REFERENCES `plain_emrs`.`patient` (`patient_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_table1_emergency_contact1`
    FOREIGN KEY (`emergency_contact_id`)
    REFERENCES `plain_emrs`.`emergency_contact` (`emergency_contact_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
